!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-image-compress",["exports","@angular/core"],t):t((e=e||self)["ngx-image-compress"]={},e.ng.core)}(this,(function(e,t){"use strict";var r={Up:1,Down:3,Right:6,Left:8,UpMirrored:2,DownMirrored:4,LeftMirrored:5,RightMirrored:7,NotJpeg:-1,NotDefined:-2};r[r.Up]="Up",r[r.Down]="Down",r[r.Right]="Right",r[r.Left]="Left",r[r.UpMirrored]="UpMirrored",r[r.DownMirrored]="DownMirrored",r[r.LeftMirrored]="LeftMirrored",r[r.RightMirrored]="RightMirrored",r[r.NotJpeg]="NotJpeg",r[r.NotDefined]="NotDefined";var n=function(){function e(){}return e.getOrientation=function(e,t){var r=new FileReader;try{r.onload=function(e){var n=new DataView(r.result);if(65496!==n.getUint16(0,!1))return t(-2);for(var i=n.byteLength,o=2;o<i;){var a=n.getUint16(o,!1);if(o+=2,65505===a){if(1165519206!==n.getUint32(o+=2,!1))return t(-1);var d=18761===n.getUint16(o+=6,!1);o+=n.getUint32(o+4,d);var c=n.getUint16(o,d);o+=2;for(var u=0;u<c;u++)if(274===n.getUint16(o+12*u,d))return t(n.getUint16(o+12*u+8,d))}else{if(65280!=(65280&a))break;o+=n.getUint16(o,!1)}}return t(-1)},r.readAsArrayBuffer(e)}catch(e){return t(0)}},e.uploadFile=function(t){return new Promise((function(r,n){var i=t.createElement("input");t.setStyle(i,"display","none"),t.setProperty(i,"type","file"),t.setProperty(i,"accept","image/*"),t.listen(i,"click",(function(e){e.target.value=null})),t.listen(i,"change",(function(t){var i=t.target.files[0],o=new FileReader;o.onloadend=function(t){try{e.getOrientation(i,(function(e){r({image:o.result,orientation:e})}))}catch(t){n(t)}};try{o.readAsDataURL(i)}catch(e){console.warn("ngx-image-compress - probably no file have been selected: "+e),n("No file selected")}})),i.click()}))},e.compress=function(e,t,n,i,o){return void 0===i&&(i=50),void 0===o&&(o=50),new Promise((function(a,d){o/=100,i/=100;var c=new Image;c.onload=function(){var d,u,s=n.createElement("canvas"),f=s.getContext("2d");if(d=c.naturalWidth,u=c.naturalHeight,t===r.Right||t===r.Left){var g=d;d=u,u=g}s.width=d*i,s.height=u*i;var l=Math.PI/180;t===r.Up?f.drawImage(c,0,0,s.width,s.height):t===r.Right?(f.save(),f.rotate(90*l),f.translate(0,-s.width),f.drawImage(c,0,0,s.height,s.width),f.restore()):t===r.Left?(f.save(),f.rotate(-90*l),f.translate(-s.width,0),f.drawImage(c,0,0,s.height,s.width),f.restore()):t===r.Down?(f.save(),f.rotate(180*l),f.translate(-s.width,-s.height),f.drawImage(c,0,0,s.width,s.height),f.restore()):f.drawImage(c,0,0,s.width,s.height);var h=e.substr(5,e.split(";")[0].length-5),p=s.toDataURL(h,o);a(p)},c.src=e}))},e.byteCount=function(e){return encodeURI(e).split(/%..|./).length-1},e}(),i=function(){function e(e){this.DOC_ORIENTATION=r,this.render=e.createRenderer(null,null)}return e.prototype.byteCount=function(e){return n.byteCount(e)},e.prototype.uploadFile=function(){return n.uploadFile(this.render)},e.prototype.compressFile=function(e,t,r,i){return void 0===r&&(r=50),void 0===i&&(i=50),n.compress(e,t,this.render,r,i)},e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[{type:t.RendererFactory2}]},e}();e.DOC_ORIENTATION=r,e.NgxImageCompressService=i,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-image-compress.umd.min.js.map